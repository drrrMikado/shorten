"use strict";document.addEventListener("DOMContentLoaded",()=>{const{copyBtnElem:e,submitBtnElem:t,formElem:n,urlInputElem:o,errElem:s}={copyBtnElem:document.getElementById("shortenCopyButton"),submitBtnElem:document.getElementById("shortenSubmitButton"),formElem:document.getElementById("shortenForm"),urlInputElem:document.getElementById("shortenURLInput"),errElem:document.getElementById("errorMsg")},r=e=>{s.innerHTML=e,s.style.display="block",setTimeout(()=>{s.style.display="none",s.innerHTML=""},1e3)},l=n=>{n.preventDefault(),e.style.display="none",t.style.display="block",o.removeEventListener("keyup",l),o.removeEventListener("change",l)};n.addEventListener("submit",n=>{n.preventDefault();let s=new XMLHttpRequest;s.open("POST","/api/shorten"),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.onload=(()=>{let n=JSON.parse(s.responseText);200==s.status?n.errcode?r(n.errmsg):(e.style.display="block",t.style.display="none",o.addEventListener("keyup",l),o.addEventListener("change",l)):r(s.statusText)}),s.send("url="+o.value)}),e.addEventListener("click",t=>{if(t.preventDefault(),!navigator.clipboard)return void r("unable to copy");const{state:n}=navigator.permissions.query({name:"clipboard-write"});"denied"!=n?navigator.clipboard.writeText(o.value).then(()=>{let t;e.classList.add("copied"),clearTimeout(t),t=setTimeout(()=>{e.classList.remove("copied")},1e3)}).catch(()=>{r("unable to copy")}):r("clipboard permission is denied.")})});